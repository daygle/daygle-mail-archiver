{% extends "base.html" %}

{% block page_title %}Quarantine Message #{{ item.id }}{% endblock %}

{% block content %}
<div class="card">
    <div class="card-header">
        <div class="card-title">
            <i class="fas fa-biohazard"></i>
            <span>Quarantine Message #{{ item.id }}</span>
        </div>
    </div>
    <div class="card-body">
        <dl class="row">
            <dt class="col-sm-3">Subject</dt><dd class="col-sm-9">{{ item.subject or '(no subject)' }}</dd>
            <dt class="col-sm-3">Sender</dt><dd class="col-sm-9">{{ item.sender or 'unknown' }}</dd>
            <dt class="col-sm-3">Virus</dt><dd class="col-sm-9">{{ item.virus_name or '' }}</dd>
            <dt class="col-sm-3">Quarantined At</dt><dd class="col-sm-9">{{ item.quarantined_at }}</dd>
            <dt class="col-sm-3">Reason</dt><dd class="col-sm-9">{{ item.reason or '' }}</dd>
        </dl>

        <h5>Preview</h5>
        {% if preview %}
            <pre class="code-block small" style="max-height:400px; overflow:auto;">{{ preview }}</pre>
        {% else %}
            <p class="text-muted">No preview available</p>
        {% endif %}

        <div class="mt-3">
            <form method="post" action="/quarantine/{{ item.id }}/restore" style="display:inline;">
                <button class="btn btn-success">Restore</button>
            </form>
            <form method="post" action="/quarantine/{{ item.id }}/delete" style="display:inline; margin-left: 1rem;" onsubmit="return confirm('Delete this quarantined message permanently?');">
                <button class="btn btn-danger">Delete</button>
            </form>
            <a href="/quarantine" class="btn btn-secondary ms-2">Back</a>
        </div>
    </div>
</div>
{% endblock %}