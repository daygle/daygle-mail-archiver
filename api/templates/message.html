{% extends "base.html" %}
{% block content %}

<h1 class="mb-4 fw-bold">Message #{{ message.id }}</h1>

<div class="card shadow-sm mb-4">
    <div class="card-body">
        <p><strong>Subject:</strong> {{ message.subject }}</p>
        <p><strong>From:</strong> {{ message.sender }}</p>
        <p><strong>To:</strong> {{ message.recipients }}</p>
        <p><strong>Date:</strong> {{ message.date or message.created_at }}</p>
        <p><strong>Account:</strong> {{ message.account }}</p>
        <p><strong>Folder:</strong> {{ message.folder }} (UID {{ message.uid }})</p>
        <p><strong>Storage path:</strong> <code>{{ message.storage_path }}</code></p>
    </div>
</div>

<form method="post" action="/messages/{{ message.id }}/delete"
      onsubmit="return confirm('Permanently delete this archived email?');">
    <button class="btn btn-danger mb-4">Delete from Archive</button>
</form>

{% if attachments and attachments|length > 0 %}
<div class="card shadow-sm mb-4">
    <div class="card-header fw-bold">
        Attachments
    </div>
    <ul class="list-group list-group-flush">
        {% for att in attachments %}
            <li class="list-group-item">
                <strong>{{ att.filename or "(no filename)" }}</strong>
                <span class="text-muted"> â€” {{ att.content_type }} ({{ att.size }} bytes)</span>
            </li>
        {% endfor %}
    </ul>
</div>
{% endif %}

<div class="card shadow-sm">
    <div class="card-header fw-bold">
        Body (plaintext)
    </div>
    <div class="card-body">
        <pre>{{ body_text }}</pre>
    </div>
</div>

<div class="mt-4">
    <a href="/messages" class="btn btn-secondary">&laquo; Back to list</a>
</div>

{% endblock %}